@model Motax.ViewModels.DetailCarVM
@{
    ViewData["Title"] = "Detail Car";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="site-breadcrumb" style="background: url(/Frontend/assets/img/breadcrumb/01.jpg)">
    <div class="container">
        <h2 class="breadcrumb-title">Detail Car</h2>
        <ul class="breadcrumb-menu">
            <li><a asp-action="Index" asp-controller="Home">Home</a></li>
            <li class="active">@Model.Name</li>
        </ul>
    </div>
</div>


<div class="car-item-single bg py-120">
    <div class="container">
        <div class="car-single-wrapper">
            <div class="row">
                <div class="col-lg-8">
                    <div class="car-single-details">
                        <div class="car-single-widget">
                            <div class="car-single-top">
                                <span class="car-status status-1">@Model.NameBrand</span>
                                <h3 class="car-single-title">@Model.Name</h3>
                                <ul class="car-single-meta">
                                    <li><i class="far fa-clock"></i> Listed On: Sat, Jan 25, 2023</li>
                                    <li><i class="far fa-eye"></i> Views: 850</li>
                                </ul>
                            </div>
                            <div class="car-single-slider">
                                <div class="item-gallery">
                                    <div class="flexslider-thumbnails">
                                        <ul class="slides">

                                            @if (!string.IsNullOrEmpty(Model.ImageMultiple))
                                            {

                                                var imagePaths = Model.ImageMultiple.Split(',');
                                                foreach (var imagePath in imagePaths)
                                                {
                                                    <li data-thumb="@imagePath">
                                                        <img src="@imagePath" alt="@Model.Name">
                                                    </li>
                                                }
                                            }

                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="car-single-widget">
                            <h4 class="mb-4">Key Information</h4>
                            <div class="car-key-info">
                                <div class="row">
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-drive"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>Body Type</span>
                                                <h6>@Model.BodyType</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-drive"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>Condition</span>
                                                <h6>@Model.Condition</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-speedometer"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>Mileage</span>
                                                <h6>@Model.Mileage</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-settings"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>Transmission</span>
                                                <h6>@Model.Transmission</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-drive"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>Year</span>
                                                <h6>@Model.Year</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-gas-station"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>Fuel Type</span>
                                                <h6>@Model.FuelType</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-drive"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>Color</span>
                                                <h6>@Model.Color</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-drive"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>Doors</span>
                                                <h6>@Model.Doors</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-drive"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>Cylinders</span>
                                                <h6>@Model.Cylinders</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-drive"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>Engine Size</span>
                                                <h6>@Model.EngineSize</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4 col-6">
                                        <div class="car-key-item">
                                            <div class="car-key-icon">
                                                <i class="flaticon-drive"></i>
                                            </div>
                                            <div class="car-key-content">
                                                <span>VIN</span>
                                                <h6>@Model.Vin</h6>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="car-single-widget">
                            <div class="car-single-overview">
                                <h4 class="mb-3">Description</h4>
                                <div class="mb-4">
                                    @Html.Raw(Model.Title)
                                </div>
                                <h4 class="mb-3">Car Features</h4>
                                <div class="row mb-3">
                                    <div class="col-lg-4">
                                        <ul class="car-single-list">
                                            <li><i class="far fa-check-circle"></i> Multi-zone A/C</li>
                                            <li><i class="far fa-check-circle"></i> Heated front seats</li>
                                            <li><i class="far fa-check-circle"></i> Navigation system</li>
                                            <li><i class="far fa-check-circle"></i> Leather seats</li>
                                        </ul>
                                    </div>
                                    <div class="col-lg-4">
                                        <ul class="car-single-list">
                                            <li><i class="far fa-check-circle"></i> Premium sound system</li>
                                            <li><i class="far fa-check-circle"></i> Bluetooth</li>
                                            <li><i class="far fa-check-circle"></i> Andriod Auto</li>
                                            <li><i class="far fa-check-circle"></i> Intermittent wipers</li>
                                        </ul>
                                    </div>
                                    <div class="col-lg-4">
                                        <ul class="car-single-list">
                                            <li><i class="far fa-check-circle"></i> Memory seat</li>
                                            <li><i class="far fa-check-circle"></i> Adaptive Cruise Control</li>
                                            <li><i class="far fa-check-circle"></i> Cooled Seats</li>
                                            <li><i class="far fa-check-circle"></i> Keyles Start</li>
                                        </ul>
                                    </div>
                                </div>

                                <h4 class="mb-4">Location</h4>
                                <div class="car-single-map">
                                    <div class="contact-map">
                                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d96708.34194156103!2d-74.03927096447748!3d40.759040329405195!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x4a01c8df6fb3cb8!2sSolomon%20R.%20Guggenheim%20Museum!5e0!3m2!1sen!2sbd!4v1619410634508!5m2!1sen!2s" style="border:0;" allowfullscreen loading="lazy"></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="car-single-widget">
                            <div class="car-single-review">
                                <div class="blog-comments mb-0">
                                    <h4>Reviews (@Model.Comments.Count)</h4>

                                    <div class="blog-comments-wrapper">
                                        @foreach (var comment in Model.Comments)
                                        {
                                            <div class="blog-comments-single">

                                                <img src="~/Images/Account/Avatar/@comment.AvatarUrl" alt="User Avatar" class="avatar-img">

                                                <div class="blog-comments-content">
                                                    <h5 >@comment.AccountName</h5>
                                                    <div style="margin-top:10px" class="comment-rating">
                                                        @for (int i = 1; i <= 5; i++)
                                                        {
                                                            if (i <= comment.Rating)
                                                            {
                                                                <i class="fas fa-star"></i>
                                                            }
                                                            else
                                                            {
                                                                <i class="far fa-star"></i>
                                                            }
                                                        }
                                                    </div>
                                                    <span><i class="far fa-clock"></i> @comment.CommentDate.ToString("MMMM dd, yyyy")</span>
                                                    <p>@comment.Comment1</p>
                                                </div>
                                            </div>
                                        }
                                    </div>

                                    <div class="blog-comments-form">
                                        <h4>Leave A Review</h4>
                                        <form asp-action="AddComment" method="post">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group car-review-rating">
                                                        <label>Your Rating</label>
                                                        <div class="star-rating">
                                                            <i class="far fa-star" data-value="1"></i>
                                                            <i class="far fa-star" data-value="2"></i>
                                                            <i class="far fa-star" data-value="3"></i>
                                                            <i class="far fa-star" data-value="4"></i>
                                                            <i class="far fa-star" data-value="5"></i>
                                                        </div>
                                                        <input type="hidden" name="Rating" id="Rating" value="0">
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <textarea class="form-control" name="Comment1" rows="5" placeholder="Your Comment*"></textarea>
                                                    </div>
                                                    <input type="hidden" name="CarId" value="@Model.Id" />
                                                    <button type="submit" class="theme-btn"><span class="far fa-paper-plane"></span> Submit Review</button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="col-lg-4">
                    <div class="car-single-widget">
                        <h4 class="car-single-price">$@Model.Price</h4>
                        <ul class="car-single-meta">
                            <li><i class="fa-regular fa-gauge-high"></i> @Model.PriceType</li>
                            <li><i class="far fa-location-dot"></i> @Model.AddressDealer</li>
                        </ul>
                    </div>
                    <div class="car-single-widget">
                        <div class="car-single-author">

                            <img src="~/Frontend/assets/img/car/author.jpg" alt="">
                            <div class="car-single-author-content">
                                <h5>Marid Anderson</h5>
                                <span>Customer Advisor</span>
                                <div class="car-single-author-social">
                                    <a href="#"><i class="fab fa-facebook"></i></a>
                                    <a href="#"><i class="fab fa-instagram"></i></a>
                                    <a href="#"><i class="fab fa-twitter"></i></a>
                                    <a href="#"><i class="fab fa-linkedin"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="car-single-widget">
                        <h5 class="mb-3">Contact Details</h5>
                        <div class="car-single-form">
                            <form asp-action="Contact" asp-controller="Dealer" method="post">
                                <input type="hidden" name="dealerId" value="@Model.Id" />
                                <div class="form-group">
                                    <input type="text" class="form-control" name="name" placeholder="Enter Name">
                                </div>
                                <div class="form-group">
                                    <input type="text" class="form-control" name="email" placeholder="Enter Email">
                                </div>
                                <div class="form-group">
                                    <textarea class="form-control" name="message" rows="3" placeholder="Write Message"></textarea>
                                </div>
                                <div class="form-group">
                                    <button type="submit" class="theme-btn">Send Now<i class="fas fa-arrow-right-long"></i></button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="car-single-widget">
                        <div class="car-single-form">
                            <form asp-action="Checkout" asp-controller="Order" method="post">
                                <input type="hidden" name="carId" value="@Model.Id" />
                                <div class="form-group">
                                    <button type="submit" class="theme-btn" style="width:100%;background-color:darkblue">Order Now<i class="fas fa-arrow-right-long"></i></button>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>
            </div>

            <div class="car-single-related mt-5">
                <h3 class="mb-30">Related Listing</h3>
                <div class="row">
                    @if (Model.RelatedCars != null)
                    {
                        @foreach (var item in Model.RelatedCars)
                        {
                            <div class="col-md-6 col-lg-4 col-xl-3">
                                <div class="car-item">
                                    <div class="car-img">
                                        <span class="car-status status-1">@item.Condition</span>
                                        <img src="~/Images/Car/Single/@item.ImageSingle" alt="@item.Name">
                                        <div class="car-btns">
                                            <a href="#"><i class="far fa-heart"></i></a>
                                            <a href="#"><i class="far fa-arrows-repeat"></i></a>
                                        </div>
                                    </div>
                                    <div class="car-content">
                                        <div class="car-top">
                                            <h4><a href="#">@item.Name</a></h4>
                                            <div class="car-rate">
                                                @for (int i = 1; i <= 5; i++)
                                                {
                                                    if (i <= Math.Ceiling(item.AverageRating))
                                                    {
                                                        <i class="fas fa-star"></i>
                                                    }
                                                    else
                                                    {
                                                        <i class="far fa-star"></i>
                                                    }
                                                }
                                                <span>@item.AverageRating.ToString("0.0") (@item.ReviewCount Reviews)</span>
                                            </div>
                                        </div>
                                        <ul class="car-list">
                                            <li><i class="far fa-steering-wheel"></i>@item.Transmission</li>
                                            <li><i class="far fa-road"></i>@item.Mileage km / @item.FuelType</li>
                                            <li><i class="far fa-car"></i>Model: @item.Year</li>
                                            <li><i class="far fa-gas-pump"></i>@item.FuelType</li>
                                        </ul>
                                        <div class="car-footer">
                                            <span class="car-price">$@item.Price</span>
                                            <a asp-action="Detail" asp-controller="Car" asp-route-id="@item.Id" class="theme-btn"><span class="far fa-eye"></span>Details</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }}
                </div>
            </div>

        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('.star-rating i').on('mouseover', function () {
                var rating = $(this).data('value');
                highlightStars(rating);
            });

            $('.star-rating i').on('mouseout', function () {
                var rating = $('#Rating').val();
                highlightStars(rating);
            });

            $('.star-rating i').on('click', function () {
                var rating = $(this).data('value');
                $('#Rating').val(rating);
                highlightStars(rating);
            });

            function highlightStars(rating) {
                $('.star-rating i').each(function () {
                    var starValue = $(this).data('value');
                    if (starValue <= rating) {
                        $(this).removeClass('far').addClass('fas');
                    } else {
                        $(this).removeClass('fas').addClass('far');
                    }
                });
            }
        });
    </script>
    <style>
        .avatar-img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 15px;
        }

        .star-rating, .comment-rating {
            display: flex;
        }

            .star-rating i, .comment-rating i {
                font-size: 24px;
                color: #ccc;
                cursor: pointer;
            }

                .star-rating i.fas, .comment-rating i.fas {
                    color: #f39c12; /* Yellow color for filled stars */
                }
    </style>
}